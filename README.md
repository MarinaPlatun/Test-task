# Test task

## Описание
Проект состоит из двух сервисов-генераторов и сервиса-регистратора, которые посылают и принимают сообщения.
Сервисы-генераторы generatorOne и generatorTwo по таймеру - 2 секунды для generatorOne и 4 секунды для generatorTwo - создают в базе данных объект событие (NEW), а затем отправляют сообщение о том, что событие создано, кто (какой сервис) является создателем. Пакетное ожидание отправки 10 секунд.
Сервис-регистратор registrator с помощью пакетной обработки(размер кол-ва 3 сообщения) получает через кафку сообщения о событиях, создает в БД запись о событии, а затем отсылает ответное сообщение-подтверждение.
Сервисы-генераторы получают подтверждения, находят в своей БД событие и отмечают его как обработанное (CONFIRMED).

## Технологии
*   **Язык:** Java 21
*   **Фреймворк:** Spring Boot [4]
*   **Сборка:** Gradle
*   **База данных:** PostgreSQL
*   **Инструменты:** Lombok, Spring Data JPA

Проект должен целиком и полностью собирается и запускается при помощи docker compose:

- `docker compose build`
- `docker compose up`


### Примеры REST API (для HTTP)
*   **Получить данные о количестве сгенерированных сообщений(allEvents), сколько из них обработано(confirmedEvents), а сколько нет(newEvents):
<br>** `GET /generator/one/all`
<br> `GET /generator/two/all`
*   **Получить список событий с поддержкой пэйджинга, фильтрацией по датам (дата начала и дата конца периода), по типу события, по источнику:
<br>** `POST /registrator/all?page=0&size=1&sort=eventType`
		
Описание:
<br> eventType - тип события, может принимать значения "SUN", "RAIN", "SNOW", "FOG"
<br> creator - источник события, может принимать значения "generatorOne", "generatorTwo"

Body: 
``` json
{ "dateFrom": "01-01-2020",
  "dateTo": "08-01-2026",
  "eventType": null,
  "creator": null
}
 ```

Пример ответа сообщения:
``` json
{
    "dtoList": [
        {
            "id": 77,
            "idEvent": 51,
            "eventType": "RAIN",
            "creator": "generatorOne",
            "createdBy": "2026-01-06T20:07:01.427Z",
            "createdByEvent": "2026-01-06T20:06:53.342Z"
        }
    ],
    "filterDataDto": {
        "creator": null,
        "dateFrom": "01-01-2020",
        "dateTo": "08-01-2026",
        "eventType": null
    },
    "pageable": {
        "currentPage": 0,
        "numberOfElements": 1,
        "numberOfResults": 1
    }
}
```
<br>Сервис-генератор 1 будет доступен по адресу: `http://localhost:8081`.
<br>Сервис-генератор 2 будет доступен по адресу: `http://localhost:8082`.
<br>Сервис-генератор будет доступен по адресу: `http://localhost:8083`.

## Структура проекта
*   `controller/`: Обработка HTTP-запросов.
*   `config/`: Настройка конфигураций.
*   `dto/`: Классы обертки dto.
*   `kafka/`: Взаимодействие с kafka.
*   `model/`: Сущности (JPA Entities).
*   `repository/`: Взаимодействие с БД.
*   `service/`: Бизнес-логика.

